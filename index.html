<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
  </head>
  <body>
    <canvas id="myCanvas" width="1000" height="610" style="border-style:dashed; margin: 35px auto; display:block;"></canvas>

    <script>

    var canvas = document.getElementById('myCanvas');

    class Paddle {
      constructor(x, y, width, height, speed) {
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
        this.speed = 50;
        this.vx = 5;
        this.vy = 2;
      }
    }

    class Player extends Paddle {
      constructor(x, y, width, height) {
        super(x, y, width, height);
        this.name = "Player";
      }
    }

    class Computer extends Paddle {
      constructor(x, y, width, height) {
        super(x, y, width, height);
        this.name = "Computer";
      }
    }

    class Ball {
      constructor(radius, startAngle, endAngle) {
        this.radius = radius;
        this.startAngle = startAngle;
        this.endAngle = endAngle;
        this.x = Math.random() * 800;
        this.y = Math.random() * 500;
        this.vx = 5;
        this.vy = -2;
      }
    }

    Paddle.prototype.move = function move(speed) {
      this.speed = speed;
      this.y += this.speed;
    }

    Player.prototype.render = function render() {
      var playerCanvas = document.getElementById("myCanvas");
      var playerContext = playerCanvas.getContext('2d');
      playerContext.fillStyle = "black";
      playerContext.fillRect(this.x, this.y, this.width, this.height);
      playerContext.closePath();
    }

    Computer.prototype.render = function render() {
      var computerCanvas = document.getElementById("myCanvas");
      var computerContext = computerCanvas.getContext('2d');
      computerContext.fillStyle = "black";
      computerContext.fillRect(this.x, this.y, this.width, this.height);
      computerContext.closePath();
    }

    Computer.prototype.update = function update(ball) {
      ball.x += ball.vx;
      ball.y += ball.vy;
      var left_x = ball.x - 50;
      var right_x = ball.x + 50;
      var top_y = ball.y - 50;
      var bottom_y = ball.y + 50;

      if (bottom_y < canvas.height/2 && left_x > this.x + this.width && right_x < canvas.width/2) {
        if (this.y > 0) {
          this.move(-5);
        } else if ((this.y + this.height)/2 <= 305) {
          this.move(5);
        }
      } else if (bottom_y > canvas.height/2 && left_x > this.x + this.width && right_x < canvas.width/2) {
        if ((this.y + this.height)/2 > 305) {
          this.move(-5);
        } else if (this.y < 460) {
          this.move(5);
        }
      }
    }

    Ball.prototype.render = function render() {
      var ballCanvas = document.getElementById("myCanvas");
      var ballContext = ballCanvas.getContext('2d');
      ballContext.beginPath();
      ballContext.arc(this.x, this.y, this.radius, this.startAngle, this.endAngle);
      ballContext.fillStyle = "#00f";
      ballContext.fill();
      ballContext.closePath();
    }

    Ball.prototype.update = function update() {
      this.x += this.vx;
      this.y += this.vy;
    }

    Ball.prototype.move = function move() {
      var canvas = document.getElementById("myCanvas");
      var ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, 1000, 610);
      render();

      var num = Math.floor(Math.random()*7) + 1;
      num *= Math.floor(Math.random()*2) == 1 ? 1 : -1;

      if (this.y + this.vy > (canvas.height - 35) ||
          this.y + this.vy < 35) {
            this.vy = -this.vy;
      }

      if (this.x + this.vx > canvas.width ||
        this.x + this.vx < 0) {
          this.x = 500;
          this.y = 305;
          this.vx = num;
          this.vy = num;
        }
    }

    function collision(ball, player, computer) {
      ball.x += ball.vx;
      ball.y += ball.vy;
      var left_x = ball.x - 50;
      var right_x = ball.x + 50;
      var top_y = ball.y - 50;
      var bottom_y = ball.y + 50;

      if (ball.vx > 0) {
        if (left_x < (player.x + player.width) && right_x > player.x && top_y < (player.y + player.height) && bottom_y > player.y) {
          ball.vx = -ball.vx;
          ball.vy += (player.vy / 2);
          ball.x += ball.vx;
        }
      } else {
        if (left_x < (computer.x + computer.width) && right_x > computer.x && top_y < (computer.y + computer.height) && bottom_y > computer.y) {
          ball.vx = -ball.vx;
          ball.vy += (computer.vy / 2);
          ball.x += ball.vx;
        }
      }
    }

    var player = new Player(900, 25, 50, 150);
    var computer = new Computer(50, 25, 50, 150)
    var ball = new Ball(50, 0, 2 * Math.PI);

    const render = () => {
      player.render();
      computer.render();
      ball.render();
    }

    var animate = window.requestAnimationFrame ||
        function(callback) { window.setTimeout(callback, 1000/60) };

    function step(timestamp) {
      render();
      animate(step);
      ball.update();
      ball.move();
      collision(ball, player, computer);
      computer.update(ball);
    }

    window.addEventListener('keydown', function(event) {
     const keyName = event.key;
     ctx = document.getElementById("myCanvas").getContext('2d');
     ctx.clearRect(0, 0, 1000, 610);
     if (keyName === "ArrowDown") {
       if (player.y < 460) {
         player.move(20);
       }
     } else if (keyName === "ArrowUp") {
       if (player.y > 0) {
         player.move(-20);
       }
     }
    });

    window.onload = animate(step);

    </script>
  </body>
</html>
